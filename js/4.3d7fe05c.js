(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"1b62":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",[n("EvenlyArticle",{scopedSlots:t._u([{key:"head",fn:function(){return[t._v("スケジュール入力")]},proxy:!0},{key:"body",fn:function(){return[n("div",{staticClass:"col-6"},[n("q-select",{attrs:{filled:"",label:"name",options:t.userlist},on:{input:t.toChousei},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1)]},proxy:!0}])}),n("EvenlyArticle",{scopedSlots:t._u([{key:"head",fn:function(){return[t._v("\n      コート抽選候補日\n    ")]},proxy:!0}])}),t.no1CandidateDate?n("ExpantionItem",{attrs:{label:"第一候補",expanded:t.expandedNo1},scopedSlots:t._u([{key:"expansion-item",fn:function(){return t._l(t.no1CandidateDate,(function(e,a){return n("span",{key:a},[t._v("\n        "+t._s(t.formatDate(e.candidate_date))+"\n      ")])}))},proxy:!0}],null,!1,2583944544)}):t._e(),t.no2CandidateDate?n("ExpantionItem",{attrs:{label:"第二候補"},scopedSlots:t._u([{key:"expansion-item",fn:function(){return t._l(t.no2CandidateDate,(function(e,a){return n("span",{key:a},[t._v("\n        "+t._s(t.formatDate(e.candidate_date))+"\n      ")])}))},proxy:!0}],null,!1,2726113731)}):t._e(),n("EvenlyArticle",{scopedSlots:t._u([{key:"head",fn:function(){return[t._v("回答者")]},proxy:!0},{key:"body",fn:function(){return t._l(t.respondent,(function(e,a){return n("span",{key:a},[t._v("\n        "+t._s(e.user_name)+"\n      ")])}))},proxy:!0}])})],1)},r=[],o=(n("7f7f"),n("6762"),n("2fdb"),n("7514"),n("967e")),c=n.n(o),u=(n("96cf"),n("fa84")),s=n.n(u),i=n("2ef0"),l=n.n(i),d=n("4177"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"justify-center"},[n("q-expansion-item",{attrs:{label:t.label,"dense-toggle":"","switch-toggle-side":"","expand-separator":""},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}},[n("div",{staticClass:"row justify-evenly text-subtitle1"},[t._t("expansion-item")],2)])],1)},f=[],h={name:"date-select-form",props:{datalist:Array,expanded:Boolean,label:String},data:function(){return{model:!1}},mounted:function(){this.model=this.expanded}},m=h,v=n("2877"),x=n("3b73"),y=n("eebe"),k=n.n(y),w=Object(v["a"])(m,p,f,!1,null,null,null),b=w.exports;k()(w,"components",{QExpansionItem:x["a"]});var _=n("cc01"),g=n("4dd5"),C={name:"Top",components:{EvenlyArticle:d["a"],ExpantionItem:b},data:function(){return{getUserResponse:Object,userlist:Array,candidateDate:Array,respondent:Array,model:null,expandedNo1:!0}},mounted:function(){this.initForm()},methods:{authCheck:function(){var t=this;return s()(c.a.mark((function e(){var n,a,r;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.authenticatedCheck();case 3:if(n=e.sent,!n){e.next=6;break}return e.abrupt("return");case 6:return a={KEY:null},e.next=9,window.prompt("Please input your key!!");case 9:return a.KEY=e.sent,e.next=12,_["a"].authentication(a);case 12:if(r=e.sent,console.log(r.data),!r.apiStatus||"ok"!==r.apiStatus.value){e.next=19;break}console.log("OK"),localStorage.token=r.data.token,e.next=21;break;case 19:throw console.log("BAD"),new Error;case 21:e.next=27;break;case 23:e.prev=23,e.t0=e["catch"](0),console.log(e.t0),t.toError401();case 27:case"end":return e.stop()}}),e,null,[[0,23]])})))()},authenticatedCheck:function(){return s()(c.a.mark((function t(){var e,n;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(localStorage.token){t.next=2;break}return t.abrupt("return",!1);case 2:return e={token:localStorage.token},t.next=5,_["a"].checkToken(e);case 5:return n=t.sent,t.abrupt("return",n.apiStatus&&"ok"===n.apiStatus.value);case 7:case"end":return t.stop()}}),t)})))()},toError401:function(){console.log("toError401"),this.$router.push({path:"auth_error"})},initForm:function(){var t=this;return s()(c.a.mark((function e(){var n;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.authCheck();case 2:return e.next=4,_["b"].getUser();case 4:return t.getUserResponse=e.sent,t.userlist=l.a.map(t.getUserResponse,"name"),e.next=8,_["b"].getCandidateDate(Object(g["a"])());case 8:n=e.sent,t.candidateDate=n.date,t.respondent=n.user;case 11:case"end":return e.stop()}}),e)})))()},toChousei:function(){var t=this,e=l.a.find(this.getUserResponse,(function(e){return l.a.includes(e.name,t.model)}));this.$store.commit("user/updateUserData",e),this.$router.push({path:"user",query:e})},toResult:function(){console.log("集計結果画面")},formatDate:function(t){var e={yaer:"long",month:"long",day:"numeric",weekday:"short"};return new Date(t).toLocaleString("ja-JP",e)},setCandidateDate:function(t,e){if(!t)return[];var n=l.a.uniq(l.a.map(t,"candidate_date_count"));return e--,n.length>e?l.a.filter(t,{candidate_date_count:n[e]}):null}},computed:{no1CandidateDate:function(){return this.setCandidateDate(this.candidateDate,1)},no2CandidateDate:function(){return this.setCandidateDate(this.candidateDate,2)}}},D=C,E=n("9989"),S=n("ddd8"),U=n("9c40"),A=Object(v["a"])(D,a,r,!1,null,null,null);e["default"]=A.exports;k()(A,"components",{QPage:E["a"],QSelect:S["a"],QBtn:U["a"]})},4177:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content"},[n("div",{staticClass:"q-pa-md"},[n("div",{staticClass:"row justify-start text-h6"},[n("div",{staticClass:"self-center"},[t._t("head")],2)])]),n("div",[n("div",{staticClass:"row justify-evenly text-subtitle1"},[t._t("body")],2)])])},r=[],o={name:"evenly-article",data:function(){return{}}},c=o,u=n("2877"),s=Object(u["a"])(c,a,r,!1,null,null,null);e["a"]=s.exports},"4dd5":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var a=function(){var t=new Date,e=t.getFullYear(),n=t.getMonth()+2,a=n<10?"0".concat(n):"".concat(n);return e+a}},cc01:function(t,e,n){"use strict";n.d(e,"b",(function(){return x})),n.d(e,"a",(function(){return y}));var a=n("967e"),r=n.n(a),o=(n("96cf"),n("fa84")),c=n.n(o),u=n("fc74"),s=n.n(u),i=n("c47a"),l=n.n(i),d=n("b383"),p=n.n(d),f=n("d3ec"),h=n.n(f),m=function t(){s()(this,t)};l()(m,"makeGetUrl",(function(t,e){return t+(h.a.empty(e)?"":"?".concat(p.a.stringify(e)))})),l()(m,"httpHeaders",(function(){return{"X-Requested-With":"csrf","Content-Type":"application/json"}})),l()(m,"toJson",(function(t){return t.json()})),l()(m,"fetchGet",function(){var t=c()(r.a.mark((function t(e){var n,a=arguments;return r.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},t.prev=1,t.next=4,window.fetch(m.makeGetUrl(e,n),{method:"GET",headers:m.httpHeaders()});case 4:return t.abrupt("return",t.sent);case 7:return t.prev=7,t.t0=t["catch"](1),console.log(t.t0),t.abrupt("return",t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e){return t.apply(this,arguments)}}()),l()(m,"fetchPost",function(){var t=c()(r.a.mark((function t(e,n){return r.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,window.fetch(e,{method:"POST",headers:m.httpHeaders(),body:JSON.stringify(n)});case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t["catch"](0),console.log(t.t0),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e,n){return t.apply(this,arguments)}}()),l()(m,"fetchPatch",function(){var t=c()(r.a.mark((function t(e,n){return r.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,window.fetch(e,{method:"PATCH",headers:m.httpHeaders(),body:JSON.stringify(n)});case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t["catch"](0),console.log(t.t0),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e,n){return t.apply(this,arguments)}}()),l()(m,"fetchDelete",function(){var t=c()(r.a.mark((function t(e){return r.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,window.fetch(e,{method:"DELETE",headers:m.httpHeaders()});case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t["catch"](0),console.log(t.t0),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}());var v={};v.BASE_URL="".concat("https://morning-peak-53590.herokuapp.com","/mng"),v.AUTH_URL="".concat("https://on8ch3z0n8.execute-api.ap-northeast-1.amazonaws.com/dev");var x={getUser:function(){return m.fetchGet("".concat(v.BASE_URL,"/user")).then((function(t){return m.toJson(t)}))},getUserSetDate:function(t){return m.fetchGet("".concat(v.BASE_URL,"/date/user"),t).then((function(t){return m.toJson(t)}))},getCandidateDate:function(t){return m.fetchGet("".concat(v.BASE_URL,"/date/month/").concat(t)).then((function(t){return m.toJson(t)}))},patchCandidateDateStatus:function(t,e){return m.fetchPatch("".concat(v.BASE_URL,"/date/").concat(t),e)}},y={authentication:function(t){return m.fetchPost("".concat(v.AUTH_URL,"/auth-api/authentication"),t).then((function(t){return m.toJson(t)}))},checkToken:function(t){return m.fetchPost("".concat(v.AUTH_URL,"/auth-api/check-token"),t).then((function(t){return m.toJson(t)}))}}}}]);